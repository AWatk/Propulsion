
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Vehicle</title><meta name="generator" content="MATLAB 8.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-01-26"><meta name="DC.source" content="Vehicle.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">classdef</span> Vehicle

    <span class="keyword">properties</span>(Constant, Access = private)
        ConversionFactors = [.3048,<span class="keyword">...</span><span class="comment">  %ft/m</span>
            2.20462,<span class="keyword">...</span><span class="comment"> %lbm/kg</span>
            0.224809];    <span class="comment">%lbf/N</span>
        UnitConversionIndex = {<span class="string">'Mass'</span>, 2;<span class="keyword">...</span><span class="comment">   %index of proper conversion factor</span>
            <span class="string">'FuelMass'</span>, 2;<span class="keyword">...</span>
            <span class="string">'FuelMassDot'</span>, 2;<span class="keyword">...</span>
            <span class="string">'Sv'</span>,1;<span class="keyword">...</span>
            <span class="string">'Thrust'</span>, 3;<span class="keyword">...</span>
            }
    <span class="keyword">end</span>

    <span class="keyword">properties</span>
        Mass <span class="comment">%total mass of vehicle</span>
        FuelMass
        FuelMassDot <span class="comment">%fuel consumption rate</span>
        Sv <span class="comment">%1x9 3D state vector [position velocity acceleration]</span>
        Thrust <span class="comment">%thrust generated by vehicle</span>
    <span class="keyword">end</span>

    <span class="keyword">properties</span>(Dependent)
        Units <span class="comment">%Unit system used (Metric, English)</span>
        CoordinateSystem <span class="comment">%Coordinate system used (Cartesian, Spherical)</span>
        <span class="comment">%        g %earth's gravitational acceleration felt by vehicle</span>
    <span class="keyword">end</span>

    <span class="keyword">properties</span>(Access = private)
        PrivateUnits = <span class="string">'Metric'</span>;
        PrivateCoordinateSystem = <span class="string">'Cartesian'</span>;
    <span class="keyword">end</span>

    <span class="keyword">methods</span>

        <span class="comment">%       Ctor******************************************************</span>
        <span class="keyword">function</span> obj = Vehicle(mass,fuelmass,fuelmassdot,sv,Thrust,CS,Units)
            <span class="keyword">if</span> nargin &gt; 0
                <span class="keyword">switch</span>(CS)
                    <span class="keyword">case</span> <span class="string">'Cartesian'</span>
                    <span class="keyword">case</span> <span class="string">'Spherical'</span>
                        obj.PrivateCoordinateSystem = CS;
                    <span class="keyword">otherwise</span>
                        error(<span class="string">'Vehicle:InvalidCoordinateSystem'</span>,<span class="keyword">...</span>
                            <span class="string">'Coordinate System ''%s'' is not supported'</span>,<span class="keyword">...</span>
                            CS);
                <span class="keyword">end</span>
                <span class="keyword">switch</span>(Units)
                    <span class="keyword">case</span> <span class="string">'Metric'</span>
                    <span class="keyword">case</span> <span class="string">'English'</span>
                        obj.PrivateUnits = Units;
                    <span class="keyword">otherwise</span>
                        error(<span class="string">'Vehicle:InvalidUnits'</span>,<span class="keyword">...</span>
                            <span class="string">'Units ''%s'' is not supported'</span>, Units);
                <span class="keyword">end</span>
                obj.Mass = mass;
                obj.FuelMass = fuelmass;
                obj.FuelMassDot = fuelmassdot;
                obj.Sv = sv;
                obj.Thrust = Thrust;
            <span class="keyword">else</span>
                obj.Mass = 0;
                obj.FuelMass = 0;
                obj.FuelMassDot = 0;
                obj.Sv = [0 0 0 0 0 0 0 0 0];
                obj.Thrust = 0;
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="comment">%       /Ctor*****************************************************</span>

        <span class="comment">%       Get Functions*********************************************</span>
        <span class="keyword">function</span> units = get.Units(obj)
            units = obj.PrivateUnits;
        <span class="keyword">end</span>

        <span class="keyword">function</span> coordinatesystem = get.CoordinateSystem(obj)
            coordinatesystem = obj.PrivateCoordinateSystem;
        <span class="keyword">end</span>
        <span class="comment">%       /Get Functions********************************************</span>

        <span class="comment">%       Set Functions*********************************************</span>
        <span class="keyword">function</span> obj = set.Units(obj,newUnits)
            <span class="keyword">switch</span>(newUnits)
                <span class="keyword">case</span> <span class="string">'Metric'</span>
                    <span class="keyword">if</span> ~strcmp(obj.PrivateUnits, newUnits)
                        obj.PrivateUnits = newUnits;
                        obj =convertPropertyUnits(obj,1./obj.ConversionFactors);
                    <span class="keyword">end</span>
                <span class="keyword">case</span> <span class="string">'English'</span>
                    <span class="keyword">if</span> ~strcmp(obj.PrivateUnits, newUnits)
                        obj.PrivateUnits = newUnits;
                        obj = convertPropertyUnits(obj,obj.ConversionFactors);
                    <span class="keyword">end</span>
                <span class="keyword">otherwise</span>
                    error(<span class="string">'Vehicle:InvalidUnits'</span>,<span class="keyword">...</span>
                        <span class="string">'Units ''%s'' is not supported'</span>, newUnits);
            <span class="keyword">end</span>
        <span class="keyword">end</span>

        <span class="keyword">function</span> obj = set.CoordinateSystem(obj,newCS)
            <span class="keyword">switch</span>(newCS)
                <span class="keyword">case</span> <span class="string">'Cartesian'</span>
                    <span class="keyword">if</span> ~strcmp(obj.PrivateCoordinateSystem, newCS)
                        obj = convertPropertyCoordinates(obj,newCS);
                        obj.PrivateCoordinateSystem = newCS;
                    <span class="keyword">end</span>
                <span class="keyword">case</span> <span class="string">'Spherical'</span>
                    <span class="keyword">if</span> ~strcmp(obj.PrivateCoordinateSystem, newCS)
                        obj = convertPropertyCoordinates(obj,newCS);
                        obj.PrivateCoordinateSystem = newCS;
                    <span class="keyword">end</span>

                <span class="keyword">otherwise</span>
                    error(<span class="string">'Vehicle:InvalidCoordinateSystem'</span>,<span class="keyword">...</span>
                        <span class="string">'Coordinate System ''%s'' is not supported'</span>,<span class="keyword">...</span>
                        newCS);
            <span class="keyword">end</span>
        <span class="keyword">end</span>

        <span class="keyword">function</span> obj = set.Mass(obj,mass)
            <span class="keyword">if</span> mass&lt;0
                error(<span class="string">'Mass must be non-negative'</span>);
            <span class="keyword">else</span>
                obj.Mass = mass;
            <span class="keyword">end</span>
        <span class="keyword">end</span>

        <span class="keyword">function</span> obj = set.FuelMass(obj,mass)
            <span class="keyword">if</span> mass&lt;0
                error(<span class="string">'Mass must be non-negative'</span>);
            <span class="keyword">else</span>
                obj.FuelMass = mass;
            <span class="keyword">end</span>
        <span class="keyword">end</span>

        <span class="keyword">function</span> obj = set.Sv(obj,sv)
            <span class="keyword">if</span> ~isequal(size(sv),[1,9])
                error(<span class="string">'Vehicle:InvalidValue'</span>,<span class="keyword">...</span>
                    <span class="string">'State vector must be 1x9 vector'</span>);
            <span class="keyword">else</span>
                obj.Sv = sv;
            <span class="keyword">end</span>
        <span class="keyword">end</span>

        <span class="keyword">function</span> obj = set.Thrust(obj,T)
            <span class="keyword">if</span> isnumeric(T)
                obj.Thrust = T;
            <span class="keyword">else</span>
                error(<span class="string">'Vehicle:InvalidValue'</span>,<span class="keyword">...</span>
                    <span class="string">'Thrust value must be numeric'</span>);
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="comment">%       /Set Functions********************************************</span>

        <span class="comment">%       Additional Functions**************************************</span>
        <span class="keyword">function</span> struct = homework1_propagate(obj,tspan)

            <span class="comment">% Define celestial body constants</span>
            g0 = 9.81; <span class="comment">%m/s^2</span>
            R0 = 6400000; <span class="comment">%m</span>

           y0 = zeros(3,1);
           y0(1) = obj.Sv(3);
           y0(2) = obj.Sv(6);
           y0(3) = obj.Mass;

            sol = ode45(@(t,y) hw1_prop_eq(t,y,g0,R0,<span class="keyword">...</span>
                obj.Thrust,obj.FuelMassDot),<span class="keyword">...</span>
                tspan,y0);


            xint1 = tspan(1):1:600;
            xint2 = 660:60:tspan(2);
            xint = [xint1 xint2];
            [y,yp] = deval(sol, xint);
            struct.position = y(1,:);
            struct.velocity = y(2,:);
            struct.acceleration = yp(2,:);
            struct.mass = y(3,:);
            struct.time = xint/(24*3600);

            <span class="comment">%define ode function to pass to ode45</span>
            <span class="keyword">function</span> dy = hw1_prop_eq(~,y,g0,R0,Thrust,fuelMassDot)
                dy = zeros(2,1);
                dy(1) = y(2);
                dy(2) = -g0*R0^2/y(1)^2 + Thrust/(y(3));
                dy(3) = fuelMassDot;
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="comment">%       /Additional Functions*************************************</span>
    <span class="keyword">end</span> <span class="comment">%/methods</span>

    <span class="comment">%       Helper Functions******************************************</span>
    <span class="keyword">methods</span>(Access = private)
        <span class="keyword">function</span> obj = convertPropertyUnits(obj,cf)
            <span class="keyword">for</span> prop=obj.UnitConversionIndex'
                <span class="keyword">if</span> ~strcmp(prop{1}, <span class="string">'Sv'</span>)
                    obj.(prop{1}) = obj.(prop{1})*cf(prop{2});
                <span class="keyword">else</span>
                    <span class="keyword">if</span> strcmp(obj.PrivateCoordinateSystem, <span class="string">'Cartesian'</span>)
                        obj.(prop{1}) = obj.(prop{1})*cf(prop{2});
                    <span class="keyword">elseif</span> strcmp(obj.PrivateCoordinateSystem, <span class="string">'Spherical'</span>)
                        sv = obj.Sv;
                        obj.Sv(3) = sv(3)*cf(prop{2});
                        obj.Sv(6) = sv(6)*cf(prop{2});
                        obj.Sv(9) = sv(9)*cf(prop{2});
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
            <span class="keyword">end</span>
        <span class="keyword">end</span>

        <span class="keyword">function</span> obj = convertPropertyCoordinates(obj,newCS)
            sv = obj.Sv;
            <span class="keyword">switch</span>(obj.PrivateCoordinateSystem)
                <span class="keyword">case</span> <span class="string">'Cartesian'</span>
                    <span class="keyword">if</span> strcmp(newCS, <span class="string">'Spherical'</span>)
                        [az,el,r] = cart2sph(sv(1),sv(2),sv(3));
                        [vaz,vel,vr] = cart2sph(sv(4),sv(5),sv(6));
                        [aaz, ael, ar] = cart2sph(sv(7),sv(8),sv(9));
                        obj.Sv = [az,el,r,vaz,vel,vr,aaz,ael,ar];
                    <span class="keyword">end</span>
                <span class="keyword">case</span> <span class="string">'Spherical'</span>
                    <span class="keyword">if</span> strcmp(newCS, <span class="string">'Cartesian'</span>)
                        [x,y,z] = sph2cart(sv(1),sv(2),sv(3));
                        [vx,vy,vz] = sph2cart(sv(4),sv(5),sv(6));
                        [ax,ay,az] = sph2cart(sv(7),sv(8),sv(9));
                        obj.Sv = [x,y,z,vx,vy,vz,ax,ay,az];
                    <span class="keyword">end</span>
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015a</a><br></p></div><!--
##### SOURCE BEGIN #####
classdef Vehicle
    
    properties(Constant, Access = private)
        ConversionFactors = [.3048,...  %ft/m
            2.20462,... %lbm/kg
            0.224809];    %lbf/N
        UnitConversionIndex = {'Mass', 2;...   %index of proper conversion factor
            'FuelMass', 2;...
            'FuelMassDot', 2;...
            'Sv',1;...
            'Thrust', 3;...
            }
    end
    
    properties
        Mass %total mass of vehicle
        FuelMass
        FuelMassDot %fuel consumption rate
        Sv %1x9 3D state vector [position velocity acceleration]
        Thrust %thrust generated by vehicle
    end
    
    properties(Dependent)
        Units %Unit system used (Metric, English)
        CoordinateSystem %Coordinate system used (Cartesian, Spherical)
        %        g %earth's gravitational acceleration felt by vehicle
    end
    
    properties(Access = private)
        PrivateUnits = 'Metric';
        PrivateCoordinateSystem = 'Cartesian';
    end
    
    methods
        
        %       Ctor******************************************************
        function obj = Vehicle(mass,fuelmass,fuelmassdot,sv,Thrust,CS,Units)
            if nargin > 0
                switch(CS)
                    case 'Cartesian'
                    case 'Spherical'
                        obj.PrivateCoordinateSystem = CS;
                    otherwise
                        error('Vehicle:InvalidCoordinateSystem',...
                            'Coordinate System ''%s'' is not supported',...
                            CS);
                end
                switch(Units)
                    case 'Metric'
                    case 'English'
                        obj.PrivateUnits = Units;
                    otherwise
                        error('Vehicle:InvalidUnits',...
                            'Units ''%s'' is not supported', Units);
                end
                obj.Mass = mass;
                obj.FuelMass = fuelmass;
                obj.FuelMassDot = fuelmassdot;
                obj.Sv = sv;
                obj.Thrust = Thrust;
            else
                obj.Mass = 0;
                obj.FuelMass = 0;
                obj.FuelMassDot = 0;
                obj.Sv = [0 0 0 0 0 0 0 0 0];
                obj.Thrust = 0;
            end
        end
        %       /Ctor*****************************************************
        
        %       Get Functions*********************************************
        function units = get.Units(obj)
            units = obj.PrivateUnits;
        end
        
        function coordinatesystem = get.CoordinateSystem(obj)
            coordinatesystem = obj.PrivateCoordinateSystem;
        end
        %       /Get Functions********************************************
        
        %       Set Functions*********************************************
        function obj = set.Units(obj,newUnits)
            switch(newUnits)
                case 'Metric'
                    if ~strcmp(obj.PrivateUnits, newUnits)
                        obj.PrivateUnits = newUnits;
                        obj =convertPropertyUnits(obj,1./obj.ConversionFactors);
                    end
                case 'English'
                    if ~strcmp(obj.PrivateUnits, newUnits)
                        obj.PrivateUnits = newUnits;
                        obj = convertPropertyUnits(obj,obj.ConversionFactors);
                    end
                otherwise
                    error('Vehicle:InvalidUnits',...
                        'Units ''%s'' is not supported', newUnits);
            end
        end
        
        function obj = set.CoordinateSystem(obj,newCS)
            switch(newCS)
                case 'Cartesian'
                    if ~strcmp(obj.PrivateCoordinateSystem, newCS)
                        obj = convertPropertyCoordinates(obj,newCS);
                        obj.PrivateCoordinateSystem = newCS;
                    end
                case 'Spherical'
                    if ~strcmp(obj.PrivateCoordinateSystem, newCS)
                        obj = convertPropertyCoordinates(obj,newCS);
                        obj.PrivateCoordinateSystem = newCS;
                    end
                    
                otherwise
                    error('Vehicle:InvalidCoordinateSystem',...
                        'Coordinate System ''%s'' is not supported',...
                        newCS);
            end
        end
        
        function obj = set.Mass(obj,mass)
            if mass<0
                error('Mass must be non-negative');
            else
                obj.Mass = mass;
            end
        end
        
        function obj = set.FuelMass(obj,mass)
            if mass<0
                error('Mass must be non-negative');
            else
                obj.FuelMass = mass;
            end
        end
        
        function obj = set.Sv(obj,sv)
            if ~isequal(size(sv),[1,9])
                error('Vehicle:InvalidValue',...
                    'State vector must be 1x9 vector');
            else
                obj.Sv = sv;
            end
        end
        
        function obj = set.Thrust(obj,T)
            if isnumeric(T)
                obj.Thrust = T;
            else
                error('Vehicle:InvalidValue',...
                    'Thrust value must be numeric');
            end
        end
        %       /Set Functions********************************************
        
        %       Additional Functions**************************************
        function struct = homework1_propagate(obj,tspan)
            
            % Define celestial body constants
            g0 = 9.81; %m/s^2
            R0 = 6400000; %m
            
           y0 = zeros(3,1);
           y0(1) = obj.Sv(3);
           y0(2) = obj.Sv(6);
           y0(3) = obj.Mass;
            
            sol = ode45(@(t,y) hw1_prop_eq(t,y,g0,R0,...
                obj.Thrust,obj.FuelMassDot),...
                tspan,y0);
            
            
            xint1 = tspan(1):1:600;
            xint2 = 660:60:tspan(2);
            xint = [xint1 xint2];
            [y,yp] = deval(sol, xint);
            struct.position = y(1,:);
            struct.velocity = y(2,:);
            struct.acceleration = yp(2,:);
            struct.mass = y(3,:);
            struct.time = xint/(24*3600);
            
            %define ode function to pass to ode45
            function dy = hw1_prop_eq(~,y,g0,R0,Thrust,fuelMassDot)
                dy = zeros(2,1);
                dy(1) = y(2);
                dy(2) = -g0*R0^2/y(1)^2 + Thrust/(y(3));
                dy(3) = fuelMassDot;
            end
        end
        %       /Additional Functions*************************************
    end %/methods
    
    %       Helper Functions******************************************
    methods(Access = private)
        function obj = convertPropertyUnits(obj,cf)
            for prop=obj.UnitConversionIndex'
                if ~strcmp(prop{1}, 'Sv')
                    obj.(prop{1}) = obj.(prop{1})*cf(prop{2});
                else
                    if strcmp(obj.PrivateCoordinateSystem, 'Cartesian')
                        obj.(prop{1}) = obj.(prop{1})*cf(prop{2});
                    elseif strcmp(obj.PrivateCoordinateSystem, 'Spherical')
                        sv = obj.Sv;
                        obj.Sv(3) = sv(3)*cf(prop{2});
                        obj.Sv(6) = sv(6)*cf(prop{2});
                        obj.Sv(9) = sv(9)*cf(prop{2});
                    end
                end
            end
        end
        
        function obj = convertPropertyCoordinates(obj,newCS)
            sv = obj.Sv;
            switch(obj.PrivateCoordinateSystem)
                case 'Cartesian'
                    if strcmp(newCS, 'Spherical')
                        [az,el,r] = cart2sph(sv(1),sv(2),sv(3));
                        [vaz,vel,vr] = cart2sph(sv(4),sv(5),sv(6));
                        [aaz, ael, ar] = cart2sph(sv(7),sv(8),sv(9));
                        obj.Sv = [az,el,r,vaz,vel,vr,aaz,ael,ar];
                    end
                case 'Spherical'
                    if strcmp(newCS, 'Cartesian')
                        [x,y,z] = sph2cart(sv(1),sv(2),sv(3));
                        [vx,vy,vz] = sph2cart(sv(4),sv(5),sv(6));
                        [ax,ay,az] = sph2cart(sv(7),sv(8),sv(9));
                        obj.Sv = [x,y,z,vx,vy,vz,ax,ay,az];
                    end
            end
        end
    end
    
end
##### SOURCE END #####
--></body></html>